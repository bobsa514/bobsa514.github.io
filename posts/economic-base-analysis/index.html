<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="theme-color" content="#494f5c">
	<meta name="msapplication-TileColor" content="#494f5c">
<meta itemprop="name" content="Economic Base Analysis using Python">
<meta itemprop="description" content="Planning economist Richard Klosterman once said, Information about an area&rsquo;s future population is incomplete without a parallel understanding of the local economy that largely shapes its future.
There are a few basic methods that are widely taught and used in planning and economic geography, and Economic Base Analysis is the oldest, simplest and most widely used technique for regional economic analysis. The Economic Base Analysis uses the assumption that The economy of a nation/region can only grow when they export their goods and services."><meta itemprop="datePublished" content="2022-09-25T21:28:54-07:00" />
<meta itemprop="dateModified" content="2022-09-25T21:28:54-07:00" />
<meta itemprop="wordCount" content="777">
<meta itemprop="keywords" content="Python,pandas,planning,economics," /><meta property="og:title" content="Economic Base Analysis using Python" />
<meta property="og:description" content="Planning economist Richard Klosterman once said, Information about an area&rsquo;s future population is incomplete without a parallel understanding of the local economy that largely shapes its future.
There are a few basic methods that are widely taught and used in planning and economic geography, and Economic Base Analysis is the oldest, simplest and most widely used technique for regional economic analysis. The Economic Base Analysis uses the assumption that The economy of a nation/region can only grow when they export their goods and services." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/economic-base-analysis/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-25T21:28:54-07:00" />
<meta property="article:modified_time" content="2022-09-25T21:28:54-07:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Economic Base Analysis using Python"/>
<meta name="twitter:description" content="Planning economist Richard Klosterman once said, Information about an area&rsquo;s future population is incomplete without a parallel understanding of the local economy that largely shapes its future.
There are a few basic methods that are widely taught and used in planning and economic geography, and Economic Base Analysis is the oldest, simplest and most widely used technique for regional economic analysis. The Economic Base Analysis uses the assumption that The economy of a nation/region can only grow when they export their goods and services."/>

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>Economic Base Analysis using Python</title>
	<link rel="stylesheet" href="/css/style.min.037b6ee8f8c1baab6a3d0a9da11c3ff18a7552471f16c59fd98538d5ce99208b.css" integrity="sha256-A3tu6PjBuqtqPQqdoRw/8Yp1UkcfFsWf2YU41c6ZIIs=" crossorigin="anonymous">
	
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="/">Boyang Sa</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					
				<a href="/posts/">Posts</a>
				<a href="/about">About</a>

				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<span class="hdr-social hide-in-mobile"><a href="https://twitter.com/MichelAndJurgen" target="_blank" rel="noopener me" title="Twitter"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a><a href="https://www.linkedin.com/in/boyang-sa/" target="_blank" rel="noopener me" title="Linkedin"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a><a href="https://github.com/bobsa514" target="_blank" rel="noopener me" title="Github"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a><a href="mailto:me@boyangsa.com" target="_blank" rel="noopener me" title="Email"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a></span><button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="/posts/">Posts</a></li>
			<li><a href="/about">About</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Sep 25, 2022</span></div>
				<h1>Economic Base Analysis using Python</h1>
			</header>
			<div class="content">
				<p>Planning economist Richard Klosterman once said, <em>Information about an area&rsquo;s future population is incomplete without a parallel understanding of the local economy that largely shapes its future.</em></p>
<p>There are a few basic methods that are widely taught and used in planning and economic geography, and Economic Base Analysis is <em>the oldest, simplest and most widely used technique for regional economic analysis.</em> The Economic Base Analysis uses the assumption that The economy of a nation/region can only grow when they <strong>export</strong> their goods and services. The local economy consists of the <em>Basic (export-oriented)</em> and <em>Non-Basic (non-export-oriented)</em> sectors.</p>
<p>The Economic Base Analysis then calculates the location quotient (LQ), which compares a local economy&rsquo;s share in a specific sector with that of a reference region which is larger than the study area (e.g. county vs. state, region vs. state, state vs.nation, etc.). When the LQ &lt; 1, there is no excess production in the local economy. When the LQ &gt; 1, the excess employment is allocated to the export sector. This employment is regarded as the basic sector employment.</p>
<p>We will then create a small project to automate this calculation process to get the top base sector (industry) in each county in the United States.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">fips_prep</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;get the county FIPS code ready&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># a master CSV sheet for all county&#39;s FIPS code</span>
</span></span><span class="line"><span class="cl">    <span class="n">fips_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/kjhealy/fips-codes/master/county_fips_master.csv&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># make sure to use the correct encoding to avoid error here</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fips_url</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ISO-8859-1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># add a leading zero for certain states, for instance, California&#39;s FIPS code is 06</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fips&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fips&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;fips&#39;</span><span class="p">,</span> <span class="s1">&#39;county_name&#39;</span><span class="p">,</span> <span class="s1">&#39;state_name&#39;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;county_name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;state_name&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">df</span>
</span></span></code></pre></div><p>Next, get the employment data for all industrial sectors. We have two options from the Census Bureau: the economic census and the county business pattern (CBP) data. The economic census data provides more accurate information, but the CBP data is published every year. We will use CBP data as an example.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">eba_data_prep</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># first, get the CBP county data as target geography</span>
</span></span><span class="line"><span class="cl">    <span class="n">cbp20url</span> <span class="o">=</span> <span class="s1">&#39;https://www2.census.gov/programs-surveys/cbp/datasets/2020/cbp20co.zip&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">cbp20url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># some data cleaning and relabeling work</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fipstate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fipstate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fipscty&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fipscty&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fips&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fipstate&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fipscty&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;fips&#39;</span><span class="p">,</span> <span class="s1">&#39;naics&#39;</span><span class="p">,</span> <span class="s1">&#39;emp&#39;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;emp&#39;</span><span class="p">:</span> <span class="s1">&#39;emp_co&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># remove all &#39;-&#39; or &#39;/&#39; from df[&#39;naics&#39;]</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;naics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;naics&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;naics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;naics&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># df[digit] = digit of df[&#39;naics&#39;]</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;digit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;naics&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;digit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;naics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># get the CBP national data as the reference geography</span>
</span></span><span class="line"><span class="cl">    <span class="n">cbp20us_url</span> <span class="o">=</span> <span class="s1">&#39;https://www2.census.gov/programs-surveys/cbp/datasets/2020/cbp20us.zip&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_us</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">cbp20us_url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_us</span> <span class="o">=</span> <span class="n">df_us</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;emp&#39;</span><span class="p">:</span> <span class="s1">&#39;emp_us&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_us</span> <span class="o">=</span> <span class="n">df_us</span><span class="p">[</span><span class="n">df_us</span><span class="p">[</span><span class="s1">&#39;lfo&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_us</span> <span class="o">=</span> <span class="n">df_us</span><span class="p">[[</span><span class="s1">&#39;naics&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_us&#39;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># get NAICS code description to make industry codes more readable</span>
</span></span><span class="line"><span class="cl">    <span class="n">naics_desc_url</span> <span class="o">=</span> <span class="s1">&#39;https://www2.census.gov/programs-surveys/cbp/technical-documentation/reference/naics-descriptions/naics2017.txt&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">naics_desc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">naics_desc_url</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&#34;,&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;cp1252&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">naics_desc</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;naics&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># join naics_desc into df, using naics as the key</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_us</span> <span class="o">=</span> <span class="n">df_us</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">naics_desc</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;naics&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># remove all &#39;-&#39; or &#39;/&#39; from df[&#39;naics&#39;]</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_us</span><span class="p">[</span><span class="s1">&#39;naics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_us</span><span class="p">[</span><span class="s1">&#39;naics&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_us</span><span class="p">[</span><span class="s1">&#39;naics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_us</span><span class="p">[</span><span class="s1">&#39;naics&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># df[digit] = digit of df[&#39;naics&#39;]</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_us</span><span class="p">[</span><span class="s1">&#39;digit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_us</span><span class="p">[</span><span class="s1">&#39;naics&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_us</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_us</span><span class="p">[</span><span class="s1">&#39;digit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;naics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
</span></span></code></pre></div><p>For some information about NAICS code, see <a href="https://www.naics.com/search/">here</a>. Finally, let&rsquo;s calculate the location quotient.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">    <span class="c1"># turn string naics_digits into a int</span>
</span></span><span class="line"><span class="cl">    <span class="n">naics_digits</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">naics_digits</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># use example of 06073 and 4-digit naics</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_co_wip</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;fips&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">county_fips</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># keep only 0 or 4 digit naics</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_co_wip</span> <span class="o">=</span> <span class="n">df_co_wip</span><span class="p">[(</span><span class="n">df_co_wip</span><span class="p">[</span><span class="s1">&#39;digit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df_co_wip</span><span class="p">[</span><span class="s1">&#39;digit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">naics_digits</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_us_wip</span> <span class="o">=</span> <span class="n">df_us</span><span class="p">[(</span><span class="n">df_us</span><span class="p">[</span><span class="s1">&#39;digit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df_us</span><span class="p">[</span><span class="s1">&#39;digit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">naics_digits</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># drop digit columns</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_co_wip</span> <span class="o">=</span> <span class="n">df_co_wip</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;digit&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_us_wip</span> <span class="o">=</span> <span class="n">df_us_wip</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_co_wip</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;naics&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">et_co</span> <span class="o">=</span> <span class="n">df_us_wip</span><span class="p">[</span><span class="n">df_us_wip</span><span class="p">[</span><span class="s1">&#39;digit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;emp_co&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">et_us</span> <span class="o">=</span> <span class="n">df_us_wip</span><span class="p">[</span><span class="n">df_us_wip</span><span class="p">[</span><span class="s1">&#39;digit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">][</span><span class="s1">&#39;emp_us&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_us_wip</span><span class="p">[</span><span class="s1">&#39;perc_co&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_us_wip</span><span class="p">[</span><span class="s1">&#39;emp_co&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">et_co</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_us_wip</span><span class="p">[</span><span class="s1">&#39;perc_us&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_us_wip</span><span class="p">[</span><span class="s1">&#39;emp_us&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">et_us</span>
</span></span><span class="line"><span class="cl">    <span class="n">df_us_wip</span><span class="p">[</span><span class="s1">&#39;lq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_us_wip</span><span class="p">[</span><span class="s1">&#39;perc_co&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_us_wip</span><span class="p">[</span><span class="s1">&#39;perc_us&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">df_us_wip</span><span class="p">[[</span><span class="s1">&#39;naics&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;emp_co&#39;</span><span class="p">,</span> <span class="s1">&#39;lq&#39;</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;emp_co&#39;</span><span class="p">:</span> <span class="s1">&#39;employment&#39;</span><span class="p">,</span> <span class="s1">&#39;lq&#39;</span><span class="p">:</span> <span class="s1">&#39;location_quotient&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># return all rows with location_quotient &gt; 1 and sort by location_quotient, keep only top 10</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;location_quotient&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;location_quotient&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">items_to_show</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">df</span>
</span></span></code></pre></div><p>Let&rsquo;s test it out. Use San Diego County (FIPS code = 06073) as example, we take the most granular NAICS code with 6-digits to the economic base analysis, and we would like to show the top 10 industries in San Diego County:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">calc_lq</span><span class="p">(</span><span class="s1">&#39;06073&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">      naics                                        description  employment  location_quotient
</span></span><span class="line"><span class="cl"><span class="m">172</span>  <span class="m">333611</span>  Turbine and Turbine Generator Set Units Manufa...        <span class="m">4146</span>          13.991899
</span></span><span class="line"><span class="cl"><span class="m">529</span>  <span class="m">541714</span>  Research and Development in Biotechnology <span class="o">(</span>exc...       <span class="m">13892</span>          11.813104
</span></span><span class="line"><span class="cl"><span class="m">113</span>  <span class="m">325413</span>        In-Vitro Diagnostic Substance Manufacturing        <span class="m">2832</span>           8.787377
</span></span><span class="line"><span class="cl"><span class="m">307</span>  <span class="m">424930</span>  Flower, Nursery Stock, and Florists<span class="err">&#39;</span> Supplies ...        <span class="m">3791</span>           7.933639
</span></span><span class="line"><span class="cl"><span class="m">658</span>  <span class="m">712130</span>                         Zoos and Botanical Gardens        <span class="m">3312</span>           7.910214
</span></span><span class="line"><span class="cl"><span class="m">219</span>  <span class="m">336611</span>                        Ship Building and Repairing        <span class="m">7783</span>           7.876611
</span></span><span class="line"><span class="cl"><span class="m">111</span>  <span class="m">325411</span>              Medicinal and Botanical Manufacturing        <span class="m">2195</span>           6.764516
</span></span><span class="line"><span class="cl"><span class="m">182</span>  <span class="m">334220</span>  Radio and Television Broadcasting and Wireless...        <span class="m">3700</span>           6.554643
</span></span><span class="line"><span class="cl"><span class="m">216</span>  <span class="m">336411</span>                             Aircraft Manufacturing       <span class="m">10162</span>           5.744526
</span></span><span class="line"><span class="cl"><span class="m">188</span>  <span class="m">334417</span>                 Electronic Connector Manufacturing        <span class="m">1121</span>           5.576313
</span></span></code></pre></div>
			</div>
			<hr class="post-end">
			<footer class="post-info">
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="/tags/python">Python</a></span><span class="tag"><a href="/tags/pandas">pandas</a></span><span class="tag"><a href="/tags/planning">planning</a></span><span class="tag"><a href="/tags/economics">economics</a></span>
				</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>777 Words</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2022-09-25 21:28 -0700</p>
			</footer>
		</article>
		<div class="post-nav thin">
		</div>
		<div id="comments" class="thin">
</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2022 <a href="/">Boyang Sa</a> &#183; <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a> &#183; <a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
		</p>
	</footer>



	<script src="/js/bundle.min.580988ed2982bcbb74a1773c7abea97b43e4c43b9324e10cda0813ec6ec4bb67.js" integrity="sha256-WAmI7SmCvLt0oXc8er6pe0PkxDuTJOEM2ggT7G7Eu2c=" crossorigin="anonymous"></script>
	

</body>

</html>
